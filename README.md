# DNA

Данный проект содержит в себе код разработки модели глубинного обучения для решения задачи бинарной классификации. Проект разработан для [международной лаборатории биоинформатики НИУ ВШЭ](https://cs.hse.ru/iai/bioinform/).

В результате работы удалось получить две модели глубинного обучения чьи F1-score равны 0.83 и 0.75, что лучше изначальной модели лаборатории, чей F1-score равен 0.39.

## Предметная область.

Помимо всем известной стандартной правой формы ДНК (B-ДНК), в 1979 году была обнаружена левосторонняя форма, называемая Z-ДНК. ![текст](pictures\DNA&ZDNA.png)

Функциональная роль Z-ДНК разнообразна, и многие из её аспектов остаются недостаточно исследованными.

На данный момент извсетно, что Z-ДНК связана с болезнью Альцгеймера, диабетом, ревматоидным артритом.

## Цель и задачи работы

Цель работы – разработка модели глубинного обучения, способной с высокой точностью предсказывать участок Z-ДНК на основе вторичных структур ДНК.

## Формат данных

На вход модель получает интервал из нукелотидов (в каждом интервале n нуклеотидов). Каждый нуклеотид имеет 1950 признака.

На выходе модель должна выдать класс каждого нуклеотида из интервала - 1, если нуклеотид принадлежит участку ZDNA, иначе 0.

Эксперименты проводились на двух датсетах - Shin и Cousine

## Метрики качества

Основная метрика качества - F1-score.

ZDNA встречается довольно редко, вследствие чего в каждом датасете, который был получен лабораторией, наблюдается сильный дисбаланс классов.

## Стартовая модель лаборатории

Лучшая модель лаборатории DeepZ, описанная в [статье](https://www.nature.com/articles/s41598-020-76203-1), основана на LSTM.

Метрики DeepZ на последовательности размером 5000 нуклеотидов:

ROC-AUC = 85%, F1-score = 39.1%

Одной из задач являлось улучшить уже существующую модель.

## Эксперименты

Эксперименты разделены на две части:

- графовые модели
- сверточные модели

В каждом из разделов были проведены следующие эксперименты:

- Эксперименты со слоями нормализации
- Эксперименты с dropout
- Эксперименты с функциями активации
- Эксперименты с количеством слоев в моделях
- Эксперименты с размером интервала

В экспериментах с графовыми моделями дополнительно проводили эксперименты с расставлением ребер.

## Полученные результаты

Самые лучшие модели, полученные в результате работы:

### Графовая модель

F1-score = 0.83
![текст](pictures\SAGE81.png)

Состоит из 13 графовых слоев. Справа на диаграмме расположено описание того, как расставлены ребра в графе. Каждый нуклеотид соединен с двумя ближайшими нуклеотидами двунаправленнвм ребром.

### Сверточная модель

F1-score = 0.75
![текст](pictures\CNN75.png)

Состоит из 13 сверточных слоев.

## Выводы

В результате проведения более 55 экспериментов были полученны графовая модель с F1-score = 0.83 и сверточная модель с F1-score = 0.75, что лучше изначальной модели лаборатории на 0.44 и 0.36 соотвественно.

На данный момент это одни из самых лучших моделей лаборатории.
